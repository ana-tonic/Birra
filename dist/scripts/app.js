import{Beer}from"/src/scripts/beer.js";const allProducts=[];let currentProducts=[];const radioButtons=[];radioButtons.push(document.querySelector("#chicken")),radioButtons.push(document.querySelector("#cake")),radioButtons.push(document.querySelector("#cheese")),radioButtons.push(document.querySelector("#salad"));const dateNow=new Date,zeroDate=new Date(0);let abvMin=0,abvMax=0,minDate=[dateNow.getFullYear(),dateNow.getMonth()+1],maxDate=[zeroDate.getFullYear(),zeroDate.getMonth()+1],radioButtonId="",inputLeftSlider=document.getElementById("input-left-abv"),inputRightSlider=document.getElementById("input-right-abv"),monthPickerAfter=document.getElementById("startDate"),monthPickerBefore=document.getElementById("brewedBeforeDate");async function filterProducts(){currentProducts.forEach((e=>{e.parentElement.removeChild(e)})),currentProducts=[];const e=document.querySelector(".name-input").value;document.querySelector(".spinner").classList.remove("visually-hidden"),await new Promise((e=>setTimeout(e,2e3))),allProducts.forEach((t=>{t.name.toLocaleLowerCase().includes(e.toLocaleLowerCase())&&filterByFood(t)&&t.price<=inputRightSlider.value&&t.price>=inputLeftSlider.value&&filterByDate(t)&&currentProducts.push(t.drawBeer(document.querySelector(".products-grid")))})),0==currentProducts.length?document.querySelector(".no-elements").classList.remove("no-elements-hide"):document.querySelector(".no-elements").classList.add("no-elements-hide"),document.querySelector(".spinner").classList.add("visually-hidden")}function filterByFood(e){if(""==radioButtonId)return!0;for(let t=0;t<e.food_pairing.length;t++)if(e.food_pairing[t].toLocaleLowerCase().includes(radioButtonId))return!0;return!1}function filterByDate(e){let t,r;return t=""!=monthPickerAfter.value?monthPickerAfter.value.split("-"):minDate.split("-"),r=""!=monthPickerBefore.value?monthPickerBefore.value.split("-"):maxDate.split("-"),(e.first_brewed[0]>t[0]||e.first_brewed[0]==t[0]&&e.first_brewed[1]>=t[1])&&(e.first_brewed[0]<r[0]||e.first_brewed[0]==r[0]&&e.first_brewed[1]<=r[1])&&(console.log(e.first_brewed),!0)}async function resetProducts(){currentProducts.length||document.querySelector(".no-elements").classList.add("no-elements-hide"),currentProducts.forEach((e=>{e.parentElement.removeChild(e)})),currentProducts=[],document.querySelector(".spinner").classList.remove("visually-hidden"),await new Promise((e=>setTimeout(e,2e3))),document.querySelector(".spinner").classList.add("visually-hidden"),allProducts.forEach((e=>{currentProducts.push(e.drawBeer(document.querySelector(".products-grid")))})),document.querySelector(".name-input").value="",""!=radioButtonId&&(document.querySelector("#"+radioButtonId).checked=!1,radioButtonId=""),inputLeftSlider.value=abvMin,inputRightSlider.value=parseInt(abvMax+.5),setValueAbv(!1),setValueAbv(!0),document.getElementById("from-lbl").innerHTML="From: "+abvMin,document.getElementById("to-lbl").innerHTML="To: "+parseInt(abvMax+.5),monthPickerAfter.value=monthPickerBefore.value=""}function saveID(){radioButtonId=this.id}function setValueAbv(e){let t,r=document.querySelector(".slider > .thumb.left"),n=document.querySelector(".slider > .thumb.right"),i=document.querySelector(".slider > .range");t=e?inputRightSlider:inputLeftSlider;let o=parseInt(t.min),a=parseInt(t.max);t.value=e?Math.max(parseInt(t.value),parseInt(inputLeftSlider.value)+1):Math.min(parseInt(t.value),parseInt(inputRightSlider.value)-1);let u=(t.value-o)/(a-o)*100;e?(n.style.right=100-u+"%",i.style.right=100-u+"%",document.getElementById("to-lbl").innerHTML="To: "+t.value):(r.style.left=u+"%",i.style.left=u+"%",document.getElementById("from-lbl").innerHTML="From: "+t.value)}fetch("https://api.punkapi.com/v2/beers?page=1&per_page=10").then((e=>{e.json().then((e=>{e.forEach((e=>{let t=e.first_brewed.split("/");t.reverse();let r=new Beer(e.id,e.name,e.tagline,t,e.description,e.food_pairing,e.abv,e.brewers_tips,e.image_url);allProducts.push(r)}))})).then((()=>{document.querySelector(".spinner").classList.add("visually-hidden"),allProducts.forEach((e=>{currentProducts.push(e.drawBeer(document.querySelector(".products-grid"))),e.price>abvMax&&(abvMax=e.price),e.price<abvMin&&(abvMin=e.price),(e.first_brewed[0]<minDate[0]||e.first_brewed[0]==minDate[0]&&e.first_brewed[1]<minDate[1])&&(minDate[0]=e.first_brewed[0],minDate[1]=e.first_brewed[1]),(e.first_brewed[0]>maxDate[0]||e.first_brewed[0]==maxDate[0]&&e.first_brewed[1]<maxDate[1])&&(maxDate[0]=e.first_brewed[0],maxDate[1]=e.first_brewed[1])})),minDate=minDate.join("-"),monthPickerAfter.setAttribute("min",minDate),monthPickerBefore.setAttribute("min",minDate),maxDate=maxDate.join("-"),monthPickerAfter.setAttribute("max",maxDate),monthPickerBefore.setAttribute("max",maxDate),inputLeftSlider.setAttribute("min",abvMin),inputLeftSlider.setAttribute("max",parseInt(abvMax+.5)),inputLeftSlider.setAttribute("value",abvMin),inputRightSlider.setAttribute("min",abvMin),inputRightSlider.setAttribute("max",parseInt(abvMax+.5)),setValueAbv(),setValueAbv(!0)}))})),document.querySelector("#btn-filter-products").addEventListener("click",filterProducts),document.querySelector("#btn-reset-filter").addEventListener("click",resetProducts),radioButtons.forEach((e=>e.addEventListener("click",saveID))),inputLeftSlider.addEventListener("input",(()=>{setValueAbv(!1)})),inputRightSlider.addEventListener("input",(()=>{setValueAbv(!0)}));const toTop=document.querySelector(".to-top");window.addEventListener("scroll",(()=>{window.pageYOffset>window.innerHeight?toTop.classList.add("active"):toTop.classList.remove("active")}));